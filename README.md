
# Кластеризация товаров категории «Фитнес и тренажеры»

Этот проект посвящен решению задачи автоматического разделения товаров из категории «Фитнес и тренажеры» на отдельные подкатегории (виды товаров) с помощью методов машинного обучения и кластеризации.

## Описание задачи

Основная цель — распределить товары по кластерам так, чтобы каждый кластер соответствовал конкретному виду спортивного оборудования (например: «беговые дорожки», «гантели», «эллиптические тренажеры» и т.д.). Характеристики бренда или состояние (б/у) не должны влиять на вид товара.


## Данные

Для анализа использовались два типа данных:
1.  **Текстовые данные:** Заголовки объявлений из файла `data_split_into_classes.csv`.
2.  **Изображения:** Векторные представления (эмбеддинги) картинок из файла `image_embeddings.npy`.

## Методология решения

Решение было реализовано в несколько этапов:

### 1. Анализ и гипотезы
Проведен ручной анализ данных для определения оптимального количества групп. Было выделено 10 основных категорий:
*   Гири, гантели, штанги.
*   Кардио-тренажеры (беговые дорожки, велотренажеры).
*   Большие силовые комплексы.
*   Дополнительный инвентарь (часы, фитнес-браслеты, абонементы).
*   Вибротренажеры.
*   Турники и брусья.
*   Скамьи.
*   Инвентарь для прыжков (скакалки, батуты).
*   Экипировка (пояса, петли).
*   Гимнастический инвентарь (мячи, обручи).

### 2. Подготовка признаков (Feature Engineering)
*   **Текстовые эмбеддинги:** Использована предобученная модель `cointegrated/rubert-tiny2` из библиотеки `sentence_transformers` для получения векторов из заголовков на русском языке.
*   **Изображения:** Загружены готовые эмбеддинги.
*   **Объединение:** Векторы текста и изображений были нормализованы с помощью `Normalizer` и объединены в один общий признак (`hstack`) с весовым коэффициентом.

### 3. Уменьшение размерности
Для очистки данных от шума и ускорения работы алгоритма использовался метод **PCA (Principal Component Analysis)**. Количество компонент подбиралось так, чтобы сохранить 95% объясненной дисперсии.

### 4. Кластеризация
В качестве основного алгоритма выбран **K-Means** с количеством кластеров $k=10$. Параметр `random_state=42` обеспечил воспроизводимость результатов.

### 5. Визуализация
Для оценки качества разделения данных использовался метод **t-SNE**, который наглядно показал формирование четких и обособленных кластеров.

## Результаты

Модель показала высокие результаты на тестовой платформе, значительно превысив установленные пороги:

*   **Homogeneity score:** 0.932 (Цель: > 0.85)
*   **Completeness score:** 0.866 (Цель: > 0.8)

**Вывод:** Комбинация текстовых и визуальных признаков вместе с правильно подобранным количеством кластеров позволила эффективно классифицировать товары без использования размеченной выборки для обучения.

## Стек технологий
*   Python
*   Pandas, NumPy
*   Scikit-learn (KMeans, PCA, Normalizer, Metrics)
*   Sentence-Transformers (RuBERT)
*   Matplotlib, Seaborn (Визуализация)
*   t-SNE

---
